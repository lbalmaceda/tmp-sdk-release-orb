description: >
  Runs the tests and publish the package using Yarn.
  The Context declared must contain an NPM_TOKEN with the Npm Automation Token.

usage:
  version: 2.1
  orbs:
    node-publisher: lbalmaceda/node-publisher@0.0.1
  workflows:
    build-and-test:
      jobs:
        - node-publisher/test:
            pkg-manager: yarn
        - node-publisher/publish:
            pkg-manager: yarn
            context:
              - publish-npm
            requires:
              - node-publisher/test
            filters:
              branches:
                only:
                  - main
