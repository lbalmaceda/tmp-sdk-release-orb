description: >
  This command verifies if the version in the package.json file is
  already published, and if not, it will attempt to publish it to Github.

parameters:
  gh-token-key:
    type: env_var_name
    default: GH_TOKEN
    description: "The name of the environment variable with the Github Access Token"
  tag-prefix:
    type: string
    default: "v"
    description: "The prefix to use for the tag name. Defaults to 'v' (i.e. v1.2.3)."

steps:
  - run:
      environment:
        GH_TOKEN_KEY: <<parameters.gh-token-key>>
        TAG_PREFIX: <<parameters.tag-prefix>>
      name: Check package version and publish to Github if required
      command: <<include(scripts/make-github-release.sh)>>
