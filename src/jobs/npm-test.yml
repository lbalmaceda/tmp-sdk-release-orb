description: >
  Installs packages and runs the tests using npm.

executor: default

parameters:
  test-command:
    type: string
    default: "npm test"
    description: "The command to run the tests with"
  pkg-manager:
    type: enum
    default: npm
    description: "Default node package manager to use"
    enum:
      - npm
      - yarn
  ignore-scripts:
    type: boolean
    default: false
    description: "Prevents your own and third-party scripts from running during dependencies pre/post install"

steps:
  - checkout
  - install-packages:
      pkg-manager: <<parameters.pkg-manager>>
      ignore-scripts: <<parameters.ignore-scripts>>
      after-deps:
        - run: <<parameters.test-command>>
